<html>
<head>
  <meta charset="UTF-8">
  <title>Pivotal Stats</title>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.2/normalize.min.css">
  <link rel="stylesheet" type="text/css" href="css/app.css">
  <!-- JS -->
  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.js"></script>
  <script src="http://code.highcharts.com/highcharts.js"></script>
  <script src="http://code.highcharts.com/modules/exporting.js"></script>
</head>
<body>

  <div class="wrapper projects clearfix"></div>

  <script src="javascript/helpers.js"></script>
  <script type="text/javascript">
    var getProjects = function(cb) {
      $.ajax({
        url: 'http://localhost:8999/api/projects',
        type: 'GET',
        dataType: 'json'
      }).done(function(res) {
        cb(res.data);
      });
    };

    $(function() {
      getProjects(function(data) {
        console.log(data);

        getTemplate('projects-template.handlebars', function(source) {
          var template = Handlebars.compile(source);
          var html     = template(data);
          $('.wrapper').prepend(html);

          for (var i = 0, imax = data.length; i < imax; i++) {
            getGraph(data[i], 'backlog');
            getGraph(data[i], 'current');
            getGraph(data[i], 'done');
          }
        });

      });

    });
  </script>


</body>
</html>
