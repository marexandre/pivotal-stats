<html>
<head>
  <meta charset="UTF-8">
  <title>Pivotal Stats</title>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.2/normalize.min.css">
  <link rel="stylesheet" type="text/css" href="css/app.css">
  <!-- JS -->
  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.js"></script>
  <script src="http://code.highcharts.com/highcharts.js"></script>
  <script src="http://code.highcharts.com/modules/exporting.js"></script>
</head>
<body>

  <div class="wrapper">
    <div class="project clearfix">
      <div id="container1" class="pie">Loading...</div>
      <div id="container2" class="pie">Loading...</div>
      <div id="container3" class="pie">Loading...</div>
    </div>

    <div class="users"></div>
  </div>

  <script id="user-stats-template-2" type="text/x-handlebars-template">
    {{#each data}}
    <div class="user">
      <div class="tasks current">
        {{#each this.current.bugs}}
          <div class="task bugs {{this.state}}"></div>
        {{/each}}
        {{#each this.current.chores}}
          <div class="task chores {{this.state}}"></div>
        {{/each}}
        {{#each this.current.features}}
          <div class="task features {{this.state}}" style="height: {{math this.estimate "*" 10 }}px;"></div>
        {{/each}}
      </div>

      <!-- <p>{{ this.name }}</p> -->
      <div class="user-meta">{{ this.initials }}</div>

      <div class="tasks backlog">
        {{#each this.backlog.features}}
          <div class="task features {{this.state}}" style="height: {{math this.estimate "*" 10 }}px;"></div>
        {{/each}}
        {{#each this.backlog.chores}}
          <div class="task chores {{this.state}}"></div>
        {{/each}}
        {{#each this.backlog.bugs}}
          <div class="task bugs {{this.state}}"></div>
        {{/each}}
      </div>

    </div>
    {{/each}}
  </script>

  <script src="javascript/helpers.js"></script>
  <script type="text/javascript">
    $(function() {
      createGraph($('#container1'), 'backlog');
      createGraph($('#container2'), 'current');
      createGraph($('#container3'), 'done');

      $.ajax({
        url: 'http://localhost:8999/api/user_stats',
        type: 'GET',
        dataType: 'json'
      }).done(function(res) {
        createUserStats(res);
      });
    });
  </script>

</body>
</html>
